"""
Here we shall use different algorithms to select the most relevant features
All experiments can be conducted independently in this section inside the main function.
"""

from sklearn.feature_selection import SelectKBest
from sklearn.ensemble import RandomForestClassifier
from sklearn.feature_selection import SelectFromModel

def feature_selection(df , target):
    model = RandomForestClassifier()
    y = target
    sfm = SelectFromModel(estimator=model)
    X = df.drop(columns=['Class', 'kfold'])
    col_names = X.columns.values
    X_transformed = sfm.fit_transform(X,y)

    support = sfm.get_support()
    return [x for x, y in zip(col_names, support) if y == True]
    
if __name__ == '__main__':
    df = pd.read_csv('../dataset/train_with_folds.csv')
    feature_selection(df, df.Class.values)