"""
This file focusses on splitting the data into train and test sets
Need not run this file if data has already been partitioned

"""

import pandas as pd
from sklearn.model_selection import train_test_split

def create_train_test_csv(df, test_size=0.25):
    
    # splitting dataset into train and test set first and separating the two
    # we do this in a stratified manner to ensure we have enough malwares in test set too.
    x_train, y_train, x_test, y_test = train_test_split(df.iloc[:,:-1], df['Class'], test_size=test_size, stratify=df['Class'],  shuffle=True)

    # now we save it as train.csv and test.csv directly.
    x_train['Class'] = x_test
    y_train['Class'] = y_test

    x_train.to_csv('../dataset/train.csv')
    y_train.to_csv('../dataset/test.csv')


def filter_columns(df, columns):
    # to remove all columns from a given df
    # columns only removed if they exist in the first place (added functionality)
    df = df.drop(columns=[col for col in columns if col in df.columns.values])
    
    return df

if __name__ == '__main__':
    df = pd.read_csv('../dataset/Android_Permission.csv')
    create_train_test_csv(df, 0.25)