import pandas as pd
from sklearn.model_selection import train_test_split


def create_train_test_csv():
    df = pd.read_csv('../dataset/Android_Permission.csv')

    # splitting dataset into train and test set first and separating the two
    # we do this in a stratified manner to ensure we have enough malwares in test set too.
    x_train, y_train, x_test, y_test = train_test_split(df.iloc[:,:-1], df['Class'], test_size=0.25, stratify=df['Class'],  shuffle=True)

    # now we save it as train.csv and test.csv directly.
    x_train['Class'] = x_test
    y_train['Class'] = y_test

    x_train.to_csv('../dataset/train.csv')
    y_train.to_csv('../dataset/test.csv')

def filter_columns(df):
    # function to be called on train/test dataset to remove unwanted columns in first round of inspection
    
    # removing columns with Safe permissions since these won't raise alerts anyway
    safeCols = [col for col in df.columns.values if '(S)' in col]
    df = df.drop(columns=safeCols)

    # removing further redundant columns
    df = df.drop(columns=['App', 'Related apps', 'Package', 'Safe permissions count'])
    
    return df

